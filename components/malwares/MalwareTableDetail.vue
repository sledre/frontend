<template>
  <b-card>
    <b-tabs content-class="">
      <b-tab title="Info">
        <b-row class="mb-2 mt-3">
          <b-col sm="1" class="text-sm-left">
            <b>Name</b>
          </b-col>
          <b-col>{{ item.name }}</b-col>
        </b-row>

        <b-row class="mb-2">
          <b-col sm="1" class="text-sm-left">
            <b>MD5</b>
          </b-col>
          <b-col>{{ item.md5 }}</b-col>
        </b-row>

        <b-row class="mb-2">
          <b-col sm="1" class="text-sm-left">
            <b>SHA256</b>
          </b-col>
          <b-col>{{ item.sha256 }}</b-col>
        </b-row>

        <b-row class="mb-2">
          <b-col sm="1" class="text-sm-left">
            <b>SHA512</b>
          </b-col>
          <b-col>{{ item.sha512 }}</b-col>
        </b-row>
      </b-tab>
      <b-tab title="Jobs">
        <b-row>
          <b-col>
            <jobs-table :jobs="item.jobs" />
          </b-col>
        </b-row>
      </b-tab>
      <b-tab title="Actions">
        <b-row class="mt-3">
          <b-col>
            <b-button
              class="md-2 ml-2"
              variant="danger"
              :disabled="item.state === 'RUNNING'"
              @click="deleteFile(item.sha256)"
            >
              Delete Malware and associated Jobs
            </b-button>
          </b-col>
        </b-row>
      </b-tab>
    </b-tabs>
  </b-card>
</template>

<script>
import JobsTable from './JobsTable'

export default {
  name: 'MalwareTableDetail',
  components: { JobsTable },
  props: {
    item: {
      type: Array,
      default: () => { return [] }
    }
  },
  data () {
    return {
      fields: [
        {
          key: 'sha256',
          label: 'SHA256 / Name',
          sortable: true
        },
        {
          key: 'label',
          label: 'Label',
          sortable: true,
          class: 'text-center'
        },
        {
          key: 'date',
          label: 'Upload Date',
          sortable: true
        },
        {
          key: 'show_details',
          label: 'Show Details',
          sortable: false
        }
      ]
    }
  },
  methods: {
    deleteFile (id) {
      this.$api.malwares.delete(id)
    }
  }
}
</script>

<style scoped>
</style>
